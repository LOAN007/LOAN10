<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Capital Lanka Loan</title>
<style>
    * {margin:0;padding:0;box-sizing:border-box;font-family:sans-serif;}
    body {background:#fff;min-height:100vh;padding:16px;}

    /* Popup */
    .popup {
        position: fixed;top:0;left:0;width:100%;height:100%;
        background: rgba(0,0,0,0.6);display:flex;justify-content:center;align-items:center;z-index:10;
    }
    .popup-content {
        background:#fff;padding:20px;border-radius:10px;text-align:center;width:90%;max-width:350px;
    }
    .popup-content h2 {margin-bottom:10px;}
    .popup-content p {margin-bottom:20px;color:#555;}
    .popup-content button {
        display:block;width:100%;margin:10px 0;padding:10px;
        border:none;border-radius:5px;font-size:16px;
        background:#007bff;color:#fff;cursor:pointer;transition:0.3s;
    }
    .popup-content button:hover {background:#0056b3;}

    /* Title animation */
    .title {
        font-size:2em;font-weight:bold;color:#007bff;
        animation: fadeIn 2s ease-in-out infinite alternate;
        margin-bottom:20px;text-align:center;
    }
    @keyframes fadeIn { from {opacity:0.3;} to {opacity:1;} }

    /* Loan form */
    .container {text-align:center;width:100%;max-width:430px;padding:20px;margin:auto;background:#fff;border-radius:12px;box-shadow:0 8px 30px rgba(0,0,0,0.06);}
    input[type=number] {
        width:100%;padding:12px;font-size:18px;margin-bottom:16px;
        border:2px solid #ccc;border-radius:5px;transition:0.3s;
    }
    input[type=number]:focus {
        border-color:#007bff;box-shadow:0 0 10px rgba(0,123,255,0.25);
        outline:none;
    }
    .btn {
        padding:12px;width:100%;border:none;border-radius:5px;
        font-size:18px;cursor:pointer;color:#fff;background:#28a745;
        animation: blink 1.5s infinite;
        text-decoration:none;display:inline-block;text-align:center;
    }
    @keyframes blink { 0%,100% {background-color:#28a745;} 50% {background-color:#218838;} }

    /* Result box */
    .result {text-align:left;margin-top:16px;font-size:16px;background:#f9fbff;border:1px solid #e6eefc;border-radius:8px;padding:14px;line-height:1.6;}
    .result strong {display:inline-block;min-width:160px;}
    .actions {margin-top:16px;display:flex;gap:10px;flex-wrap:wrap;}
    .back-btn {
        padding:10px 16px;background:#007bff;color:#fff;
        border:none;border-radius:5px;font-size:16px;cursor:pointer;flex:1;
    }
    .apply-link {flex:2;}
    .note {font-size:12px;color:#666;margin-top:8px;text-align:left;}
</style>
</head>
<body>

<!-- Language Popup -->
<div class="popup" id="langPopup">
    <div class="popup-content">
        <h2>Please select your language</h2>
        <p>You can change it later</p>
        <button onclick="selectLang('en')">English</button>
        <button onclick="selectLang('si')">‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω</button>
    </div>
</div>

<!-- Loan Form -->
<div class="container" id="loanPage" style="display:none;">
    <div class="title">Capital Lanka</div>

    <input type="number" id="amount" placeholder="Enter amount (40,000 - 600,000)" inputmode="numeric" min="40000" max="600000" step="1000">

    <!-- First Apply Button -->
    <button class="btn" id="calcBtn" onclick="applyLoan()">Apply</button>

    <div id="resultPage" style="display:none;">
        <div class="result" id="loanDetails"></div>

        <div class="actions">
            <button class="back-btn" id="backBtn" onclick="goBack()">Back</button>
            <!-- Final Apply Link -->
            <a id="finalApply" class="btn apply-link" href="#" target="_blank" rel="noopener" style="display:none;">Apply Now</a>
        </div>
        <div class="note" id="noteTxt"></div>
    </div>
</div>

<script>
let selectedLang = "en";

/* üîó Replace this with your real link */
const APPLY_URL = "https://example.com/apply"; // <-- CHANGE THIS

function selectLang(lang) {
    selectedLang = lang;

    // Update text based on language
    document.getElementById("amount").placeholder = (lang === 'si')
        ? "‡∂∏‡∑î‡∂Ø‡∂Ω ‡∂á‡∂≠‡∑î‡∑Ö‡∂≠‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂± (40,000 - 600,000)"
        : "Enter amount (40,000 - 600,000)";
    document.getElementById("calcBtn").textContent = (lang === 'si') ? "‡∂Ö‡∂∫‡∂Ø‡∑î‡∂∏‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±" : "Apply";
    document.getElementById("backBtn").textContent = (lang === 'si') ? "‡∂Ü‡∂¥‡∑É‡∑î" : "Back";
    document.getElementById("finalApply").textContent = (lang === 'si') ? "‡∂Ø‡∑ê‡∂±‡∑ä ‡∂Ö‡∂∫‡∂Ø‡∑î‡∂∏‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±" : "Apply Now";

    // Hide popup & show loan form
    document.getElementById("langPopup").style.display = "none";
    document.getElementById("loanPage").style.display = "block";

    // Scroll to top
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

function applyLoan() {
    const amount = parseFloat(document.getElementById("amount").value);
    if (isNaN(amount) || amount < 40000 || amount > 600000) {
        alert(selectedLang === 'si'
            ? "‡∂ö‡∂ª‡∑î‡∂´‡∑è‡∂ö‡∂ª 40,000 ‡∑É‡∑í‡∂ß 600,000 ‡∂Ö‡∂≠‡∂ª ‡∂∏‡∑î‡∂Ø‡∂Ω‡∂ö‡∑ä ‡∂á‡∂≠‡∑î‡∂Ω‡∂≠‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±"
            : "Please enter an amount between 40,000 and 600,000");
        return;
    }

    let interestRate = 0, months = 0;
    if (amount <= 150000) { interestRate = 9; months = 6; }
    else if (amount <= 300000) { interestRate = 13; months = 12; }
    else if (amount <= 500000) { interestRate = 14; months = 24; }
    else { interestRate = 15; months = 30; }

    const totalInterest = (amount * interestRate / 100);
    const totalPayment = amount + totalInterest;
    const monthlyInstallment = totalPayment / months;

    // Show loan details
    document.getElementById("loanDetails").innerHTML = `
        <div><strong>${selectedLang === 'si' ? "‡∂∏‡∑î‡∂Ø‡∂Ω" : "Amount"}:</strong> Rs ${amount.toLocaleString()}</div>
        <div><strong>${selectedLang === 'si' ? "‡∂¥‡∑ú‡∂Ω‡∑ì ‡∂¥‡∑ä‚Äç‡∂ª‡∂≠‡∑í‡∑Å‡∂≠‡∂∫" : "Interest Rate"}:</strong> ${interestRate}%</div>
        <div><strong>${selectedLang === 'si' ? "‡∂∏‡∑è‡∑É" : "Months"}:</strong> ${months}</div>
        <div><strong>${selectedLang === 'si' ? "‡∂ú‡∑ô‡∑Ä‡∑í‡∂∫ ‡∂∫‡∑î‡∂≠‡∑î ‡∂∏‡∑î‡∑Ö‡∑î ‡∂∏‡∑î‡∂Ø‡∂Ω" : "Total Payment"}:</strong> Rs ${totalPayment.toLocaleString(undefined, {minimumFractionDigits:2})}</div>
        <div><strong>${selectedLang === 'si' ? "‡∂∏‡∑è‡∑É‡∑í‡∂ö ‡∂ú‡∑ô‡∑Ä‡∑ì‡∂∏" : "Monthly Installment"}:</strong> Rs ${monthlyInstallment.toLocaleString(undefined, {minimumFractionDigits:2})}</div>
    `;

    // Build redirect link
    const params = new URLSearchParams({
        amount: Math.round(amount),
        months: months,
        interestRate: interestRate,
        monthly: monthlyInstallment.toFixed(2),
        lang: selectedLang
    });
    document.getElementById("finalApply").href = ${APPLY_URL}?${params.toString()};
    document.getElementById("finalApply").style.display = "inline-block";

    // Show results & hide first apply button
    document.getElementById("resultPage").style.display = "block";
    document.getElementById("calcBtn").style.display = "none";

    // Show note text
    document.getElementById("noteTxt").textContent = (selectedLang === 'si')
        ? "‡∂î‡∂∂ '‡∂Ø‡∑ê‡∂±‡∑ä ‡∂Ö‡∂∫‡∂Ø‡∑î‡∂∏‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±' ‡∂ö‡∑ä‡∂Ω‡∑í‡∂ö‡∑ä ‡∂ö‡∂ª‡∂± ‡∑Ä‡∑í‡∂ß, ‡∂î‡∂∂‡∂ú‡∑ö ‡∂≠‡∑ù‡∂ª‡∑è‡∂ú‡∂≠‡∑ä loan ‡∑Ä‡∑í‡∑É‡∑ä‡∂≠‡∂ª ‡∑É‡∂∏‡∂ú link ‡∂ë‡∂ö‡∂ß ‡∂∫‡∂±‡∑î ‡∂á‡∂≠."
        : "Click 'Apply Now' to proceed to the link with your selected loan details.";
}

function goBack() {
    document.getElementById("resultPage").style.display = "none";
    document.getElementById("finalApply").style.display = "none";
    document.getElementById("calcBtn").style.display = "inline-block";
    document.getElementById("amount").value = "";
    document.getElementById("noteTxt").textContent = "";
}
</script>

</body>
</html>
